<?xml version="1.0" encoding="UTF-8"?>


<mda>

    <!--
        A project is a set of pipelines, each pipeline is made of "steps".
        Each step receives a model and returns a model.
        Some steps accept null as the entry model, for example, steps reading
        a model.
        Some steps return the model they receive but produce some board effects,
        for example "dump" steps, "template" steps or "register" steps.
      -->

    <transformation-set>
        <!-- reads a model -->
        <model  url="models/insset_airways.xml"/>
        <!--<model model="models/Simple.xml"/>-->

        <!-- outputs the model in a readable form -->
        <dump file="target/dump.xml"/>


        <transformation-set name="sources"
                output_base="generated-sources/ete">

            <!-- Entities -->
            <velocity items="${classes}"
                        var="aClass"
                        dialect="fr.insset.jeanluc.action.semantics.dialect.JavaASGenerator"
                        template="templates/java/class2entity.vm"
                        target="${aClass.owningPackage.name.replace('.', '/')}/model/${aClass.name}.java"/>

            <!-- JPA -->
            <velocity   template="templates/java/abstract_jpa.vm"
                        target="fr/insset/jeanluc/airways/jpa/AbstractJpa.java"/>
            <velocity items="${classes}"
                        var="aClass"
                        dialect="fr.insset.jeanluc.action.semantics.dialect.JavaASGenerator"
                        template="templates/java/class2jpa.vm"
                        target="${aClass.owningPackage.name.replace('.', '/')}/jpa/${aClass.name}Jpa.java"/>

            <!-- JSF -->
            <velocity   template="templates/java/jsf_util.vm"
                        target="fr/insset/jeanluc/airways/jsf/utils/JsfUtil.java"/>
            <velocity   template="templates/java/pagination_helper.vm"
                        target="fr/insset/jeanluc/airways/jsf/utils/PaginationHelper.java"/>
            <velocity items="${classes}"
                        var="aClass"
                        dialect="fr.insset.jeanluc.action.semantics.dialect.JavaASGenerator"
                        template="templates/java/class2jsf.vm"
                        target="${aClass.owningPackage.name.replace('.', '/')}/jsf/${aClass.name}Controller.java"/>
        </transformation-set>

            <!-- JSF pages -->
        <transformation-set name="sources"
                output_base="generated-web/ete">
            <velocity   template="templates/jsf/web_inf.vm"
                        target="WEB-INF/web.xml"/>
            <velocity items="${classes}"
                        var="aClass"
                        dialect="fr.insset.jeanluc.action.semantics.dialect.JavaASGenerator"
                        template="templates/jsf/class2create.vm"
                        target="admin/${aClass.name}/Create.xhtml"/>
            <velocity items="${classes}"
                        var="aClass"
                        dialect="fr.insset.jeanluc.action.semantics.dialect.JavaASGenerator"
                        template="templates/jsf/class2edit.vm"
                        target="admin/${aClass.name}/Edit.xhtml"/>
            <velocity items="${classes}"
                        var="aClass"
                        dialect="fr.insset.jeanluc.action.semantics.dialect.JavaASGenerator"
                        template="templates/jsf/class2list.vm"
                        target="admin/${aClass.name}/List.xhtml"/>
            <velocity items="${classes}"
                        var="aClass"
                        dialect="fr.insset.jeanluc.action.semantics.dialect.JavaASGenerator"
                        template="templates/jsf/class2view.vm"
                        target="admin/${aClass.name}/View.xhtml"/>
            <velocity items="${classes}"
                        var="aClass"
                        dialect="fr.insset.jeanluc.action.semantics.dialect.JavaASGenerator"
                        template="templates/jsf/class2form.vm"
                        target="resources/ete/${aClass.name}_form.xhtml"/>
            <velocity   template="templates/jsf/template.vm"
                        target="template.xhtml"/>
            <velocity   template="templates/jsf/index.vm"
                        target="index.xhtml"/>
        </transformation-set>

    </transformation-set>

</mda>



